# 01. コア・アーキテクチャ仕様書

## 1. 概要 (Overview)
本仕様書は、アプリの主要な「ビュー（画面）」と「再生エンジン」の基本設計を定義する。

## 2. アレンジ・ビュー (Arrangement View) - *ホーム画面*
* **目的:** 曲全体（4/8/16/32小節...）を「引いた視点」で俯瞰・編集する。
* **レイアウト:**
    * **横軸:** 時間（小節、拍）。ピンチイン/アウトでズーム可能。
    * **縦軸（レーン）:** 以下の固定トラックが並ぶ。
        1.  `[ 構造 ]` (Aメロ、Bメロなどのセクション定義用)
        2.  `[ Audio (歌) ]` (録音された波形を表示)
        3.  `[ Chord / Lyric ]` (コードと歌詞を表示)
        4.  `[ Drums ]` (MIDIパターンブロック)
        5.  `[ Bass ]` (MIDIパターンブロック)
        6.  `[ Melody ]` (MIDIパターンブロック)
* **操作:**
    * **ブロック編集:** ドラッグ操作を廃し、ブロックを**タップで選択** → `[コピー]` `[切り取り]` → 目的の小節を**タップで選択** → `[貼り付け]` という「確実な」操作フローを採用する（`docs/04` スナップ機能準拠）。
    * **詳細編集:** ブロック（例：`[Bass]`のパターン）を**ダブルタップ**すると、「トラック・ビュー」（`docs/08`）にズームインする。
* **`[Chord / Lyric]` レーン詳細:**
    * `[Guit/Pno]` トグルで、コード表（グラフィック）の表示切替が可能。
    * ブロックをタップ → `[歌詞を編集]` で、テキスト入力が可能。

## 3. トラック・ビュー (Track View) - *詳細編集画面*
* **目的:** 「アレンジ・ビュー」からズームインした、1音ごとの詳細編集画面。
* **レイアウト:** `docs/08_wireframe_track_view.md` で定義された「L字型操作系」を厳守する。

## 4. グルーヴ・エンジン (Groove Engine)
* **フェイズ・モード:** 4つのMIDIトラック（Drums, Bass, Chord, Melody）が、それぞれ**独立したループ長（ステップ数）**を持つことができる。
* **伸縮する小節 (Elastic Bar):** `[構造]` レーンで、小節ごとに拍数（例：7/8）を定義できる。
